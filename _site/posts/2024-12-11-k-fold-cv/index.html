<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Rashmin Chitale">
<meta name="dcterms.date" content="2023-03-01">
<meta name="description" content="A from scratch implementation of k-fold cross validation in R and some examples">

<title>K-fold cross validation from scratch – Rashmin Chitale</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/quarto-contrib/fontawesome6-1.2.0/all.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-1.2.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>

<link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../images/logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Rashmin Chitale</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">About <img src="../..\images/aboutlogo.png" style="height:1em"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../posts.html"> 
<span class="menu-text">Posts <img src="../..\images/postslogo.png" style="height:1em"></span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Rcshmin"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://au.linkedin.com/in/rashmin-chitale-0aa989173"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">K-fold cross validation from scratch</h1>
                  <div>
        <div class="description">
          A from scratch implementation of k-fold cross validation in R and some examples
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">datascience</div>
                <div class="quarto-category">R</div>
                <div class="quarto-category">classicalml</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Rashmin Chitale </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 1, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#what-is-model-validation" id="toc-what-is-model-validation" class="nav-link active" data-scroll-target="#what-is-model-validation">What is model validation?</a></li>
  <li><a href="#different-types-of-model-validation" id="toc-different-types-of-model-validation" class="nav-link" data-scroll-target="#different-types-of-model-validation">Different types of model validation</a>
  <ul class="collapse">
  <li><a href="#train-test-split" id="toc-train-test-split" class="nav-link" data-scroll-target="#train-test-split">Train-test split</a></li>
  <li><a href="#k-fold-cross-validation" id="toc-k-fold-cross-validation" class="nav-link" data-scroll-target="#k-fold-cross-validation">K-fold cross validation</a></li>
  </ul></li>
  <li><a href="#the-algorithm" id="toc-the-algorithm" class="nav-link" data-scroll-target="#the-algorithm">The algorithm</a></li>
  <li><a href="#choice-of-k-repeated-cv-and-loocv" id="toc-choice-of-k-repeated-cv-and-loocv" class="nav-link" data-scroll-target="#choice-of-k-repeated-cv-and-loocv">Choice of <span class="math inline">\(k\)</span>, repeated CV and LOOCV</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="what-is-model-validation" class="level1">
<h1>What is model validation?</h1>
<p>A key term in k-fold cross validation is the last one. As such, I would like to preface my implementation of the algorithm, with a discussion of what <strong>model validation</strong> itself is. The word validation does not have unambiguous meaning. It is the affirmation or recognition of the validity of something. On this basis, it is pretty easy to take a guess at what model validation is. Rather than slapping the definition in right here, lets first take a step back and remind ourselves of what machine learning is, as this will assist us.</p>
<blockquote class="blockquote">
<p>Machine learning is a branch of artificial intelligence (AI) and computer science which focuses on the use of data and algorithms to imitate the way that humans learn, gradually improving its accuracy. The models that are constructed by machine learning algorithms are then used to provide insight.</p>
</blockquote>
<p>So machine learning is all about making predictions and models learning from known data such that they are able to generalise their learning to new data. And these predictions come after various processes including data preparation, model selection, model training and parameter tuning; the umbrella term used for these processes is model development. Model validation then occurs, followed by model implementation</p>
<blockquote class="blockquote">
<p>Model validation is the set of processes and activities intended to verify that models are performing as expected</p>
</blockquote>
<p>In this sense, model validation is all about checking whether the model achieve its intended purpose. Just at the name suggests, the model seeks validation. While we now know that k-fold CV is attempting to check whether the model “performs as expected”, our understanding of the algorithm has not gotten particularly deep. To remedy that, I will once again digress.</p>
<p>The realm of machine learning is a wide one indeed. There are many models, utilizing different approaches to attempt to imitate human learning. Broadly speaking, approaches can be divided into three groups</p>
<ul>
<li><strong>Supervised learning</strong>: This approach is characterized by the practice of building mathematical models on a set of data that contain both inputs and the desired output. The data is commonly labelled as being training data. Each data point or row in the training data set contains features (a.k.a covariates) and an associated label. This training data set is also commonly known as the <em>feature vector</em>; it can be decomposed into the covariates and the <em>supervisory signal</em>. An algorithm is then applied to the training data, which produces an inferred function which maps each data point (covariates or predictors) to some label or value. The ultimate goal is for the algorithm to build a function or model which learns from the training data set, and is then able to classify or regress on unseen data points which it was not trained on. Some algorithms will produce a function which is already best fitted to the training data, for example logistic regression, whereas others, may require hyperparameter tuning, an example being, k-NN.</li>
<li><strong>Unsupervised learning</strong>: In this approach we provide a data set to the algorithm, but omit the labels. An algorithm of this approach then finds structure in the data (grouping and clustering). These algorithms do not respond from ‘feedback’ as they do not use training data that is labeled or classified.</li>
<li><strong>Reinforcement learning</strong>: “An area of machine learning concerned with how software agents ought to take actions in an environment so as to maximize some notion of cumulative reward”. Straight from Wikipedia.</li>
</ul>
</section>
<section id="different-types-of-model-validation" class="level1">
<h1>Different types of model validation</h1>
<section id="train-test-split" class="level2">
<h2 class="anchored" data-anchor-id="train-test-split">Train-test split</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/train_test.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:65.0%"></p>
</figure>
</div>
</div>
</div>
<p>Phew, its good that we got that out the way. What the above chunky block of words served to illustrate is that much of machine learning is about a model learning on some data, and then predicting on new examples. Now back to the question of how can we validate/benchmark/test a model? In any context, we would definitely want to test the “generalization performance” of our model before applying it. Well if a model is built using data, then it makes sense that the only way to test it is by using data. But where does that testing data come from? This is where the <strong>train-test split</strong> comes in. Rather than using all of our available data to train our model, we split the data into a training partition, upon which the algorithm learns, and a testing partition which is not trained upon and serves as that “new/unseen” data. These splits can be of any form <span class="math inline">\(X-Y\)</span> where <span class="math inline">\(X\)</span> is the percentage of the data reserved to training the model, and <span class="math inline">\(Y\)</span> is the rest used for testing.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>train_test_split <span class="ot">&lt;-</span> <span class="cf">function</span>(data, test){</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Store data</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  t_data <span class="ot">=</span> data</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Assign amount of samples</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(test <span class="sc">&lt;</span> <span class="dv">1</span>){</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    sample_test <span class="ot">=</span> <span class="fu">ceiling</span>(test<span class="sc">*</span><span class="fu">nrow</span>(t_data))</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    sample_train <span class="ot">=</span> <span class="fu">nrow</span>(t_data) <span class="sc">-</span> sample_test</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    sample_test <span class="ot">=</span> test</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    sample_train <span class="ot">=</span> <span class="fu">nrow</span>(t_data) <span class="sc">-</span> sample_test</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Shuffle data </span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  t_data <span class="ot">=</span> t_data[<span class="fu">sample</span>(<span class="fu">nrow</span>(t_data)), ]</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row.names</span>(t_data) <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(t_data)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Assign partition and indices</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  indices <span class="ot">=</span> <span class="fu">sample</span>(<span class="at">x =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(t_data), <span class="at">size =</span> <span class="fu">nrow</span>(t_data), <span class="at">replace =</span> <span class="cn">FALSE</span>))</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  primary <span class="ot">=</span> <span class="fu">rep</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="st">"train"</span>), sample_train)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  secondary <span class="ot">=</span> <span class="fu">rep</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="st">"test"</span>), sample_test)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  total <span class="ot">=</span> <span class="fu">append</span>(primary, secondary)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  t_data<span class="sc">$</span>my.folds[indices] <span class="ot">=</span> total</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(t_data)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Just for the sake of example, I have shown how you can use the code in conjunction with other packages, to calculate a performance metric.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Example of using a train test split</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">23891</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>ttsplit <span class="ot">=</span> <span class="fu">train_test_split</span>(<span class="at">data =</span> iris, <span class="at">test =</span> <span class="fl">0.1</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>NBclassifier <span class="ot">=</span> <span class="fu">naiveBayes</span>(Species <span class="sc">~</span> Sepal.Length <span class="sc">+</span> Sepal.Width <span class="sc">+</span> Petal.Length <span class="sc">+</span> Petal.Width, </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data  =</span> <span class="fu">subset</span>(ttsplit, ttsplit<span class="sc">$</span>my.folds <span class="sc">==</span> <span class="st">"train"</span>))</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>ttsplit1 <span class="ot">=</span> <span class="fu">subset</span>(ttsplit, ttsplit<span class="sc">$</span>my.folds <span class="sc">==</span> <span class="st">"test"</span>)[, <span class="sc">-</span><span class="dv">6</span>]</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>ttsplit1<span class="sc">$</span>prediction <span class="ot">=</span> <span class="fu">predict</span>(NBclassifier, <span class="at">newdata =</span> ttsplit1, <span class="at">type =</span> <span class="st">"class"</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(ttsplit1<span class="sc">$</span>Species, ttsplit1<span class="sc">$</span>prediction)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            
             setosa versicolor virginica
  setosa          3          0         0
  versicolor      0          5         1
  virginica       0          0         6</code></pre>
</div>
</div>
<p>As can be seen from the confusion matrix, one versicolor was classified as virginica from the naive Bayes classifier.</p>
</section>
<section id="k-fold-cross-validation" class="level2">
<h2 class="anchored" data-anchor-id="k-fold-cross-validation">K-fold cross validation</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/k_fold_diagram.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:65.0%"></p>
</figure>
</div>
</div>
</div>
<p>K-fold cross validation expands upon the concept of the train-test split. In k-fold cross validation, we first randomly split our data to <span class="math inline">\(k\)</span> partitions. We then use <span class="math inline">\(k-1\)</span> of those partitions to create the training set, with the remaining partition becoming the testing set. This is repeated until each partition has served as the testing set. For example, 10 fold cross validation would split the data into 10 folds; 10% of the data would be used for testing, and 90% would be used for training. Note that, as you increase <span class="math inline">\(k\)</span> the size of the testing partition becomes smaller, while the training partition becomes bigger. I will discuss an extreme case of this, where <span class="math inline">\(k\)</span> is the largest possible size it can be later.</p>
<p>You may be wondering why k-fold cross validation is much better than the single train-test split. There are numerous reasons.</p>
<ol type="1">
<li><strong>Use of all data</strong>: A simple reason for sure. In a single test-split, some samples will be used for training, while others are reserved for testing. In k-fold, all of the available will take turns in being used for training and testing. In this regards, k-fold certainly leverages whatever data one may have to a better degree</li>
<li><strong>Reduced variance of the performance metric</strong>: A notable issue with the single train-test split is that there is a very large number of potential train-test splits. Each of these splits will produce a different value of the performance estimate when the trained model is tested against the testing set. K-fold cross validation will let us average the performance estimate <span class="math inline">\(k\)</span> times across unique train-test splits. This is especially useful as it is possible that one of those splits could be biased, or not represent the data particularly well. Model performance could be too high or too low in that case, but the algorithm would average this out. Overall, we come out, with a more robust estimate of the chosen models performance; and especially its ability to generalize to unseen data.</li>
<li><strong>Good for limited data</strong>: If data is sparse, a single train-test split will lead to a high variance in the performance metric due to skewed split. Resampling this small data set multiple times with k-fold cross validation will alleviate this issue.</li>
<li><strong>Large data sets</strong>: With large data sets (think millions, if not billions of rows) training the model and testing it might be too computationally expensive even for a single train-test split. It might be better to take a subset of the whole data, say 100,000 of those rows, and perform k-fold cross validation.</li>
<li><strong>Hyper-parameter tuning</strong>: Many machine learning algorithms come with a slight flexibility in their design. They allow the user to a change a value, which changes how the algorithm operates. K-fold cross validation allows the user to check which value for a certain model has the best performance.</li>
<li><strong>Model comparison</strong>: If our estimate of the performance metric is now more robust via k-fold cross validation — while a single train-test split is a snapshot — then we are now better able compare the performance of different machine learning models</li>
</ol>
<p>K-fold cross validation is not without its disadvantages</p>
<ol type="1">
<li><strong>More computationally expensive</strong>: K-fold cross validation require way more operations to perform, given the additional steps it performs in comparison to a single split. This also makes it longer to perform, as the model needs to be trained <span class="math inline">\(k\)</span> times, and evaluate <span class="math inline">\(k\)</span> times as well.</li>
</ol>
</section>
</section>
<section id="the-algorithm" class="level1">
<h1>The algorithm</h1>
<p>I will break this algorithm into several different functions. The first <code>k_fold_split()</code> assigns each sample a partition number such that the most even partition is made.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>k_fold_split <span class="ot">&lt;-</span> <span class="cf">function</span>(k, data){</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  k_data <span class="ot">=</span> data</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Shuffle the data</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  k_data <span class="ot">=</span> k_data[<span class="fu">sample</span>(<span class="fu">nrow</span>(k_data)), ]</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row.names</span>(k_data) <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(k_data)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Assign partition number</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">nrow</span>(data) <span class="sc">%%</span> k <span class="sc">==</span> <span class="dv">0</span>){</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Vector of randomized indices</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    indices <span class="ot">=</span> <span class="fu">sample</span>(<span class="at">x =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(k_data)), <span class="at">size =</span> <span class="fu">nrow</span>(k_data), <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Assigning indices</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    k_data<span class="sc">$</span>my.folds[indices] <span class="ot">=</span> <span class="fu">rep</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>k), <span class="fu">rep</span>(<span class="fu">nrow</span>(k_data)<span class="sc">/</span>k, k))</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">#If %% != 0, then randomize the remainder, after equally distributing the floor</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    indices <span class="ot">=</span> <span class="fu">sample</span>(<span class="at">x =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(k_data)), <span class="at">size =</span> <span class="fu">nrow</span>(k_data), <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    primary <span class="ot">=</span> <span class="fu">rep</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>k), <span class="fu">rep</span>(<span class="fu">floor</span>(<span class="fu">nrow</span>(k_data)<span class="sc">/</span>k), k))</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    secondary <span class="ot">=</span> <span class="fu">sample</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>k), <span class="at">replace =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="fu">nrow</span>(k_data) <span class="sc">%%</span> k)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    total <span class="ot">=</span> <span class="fu">append</span>(primary, secondary)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    k_data<span class="sc">$</span>my.folds[indices] <span class="ot">=</span> total</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(k_data)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>iris_split <span class="ot">=</span> <span class="fu">k_fold_split</span>(<span class="at">k =</span> <span class="dv">10</span>, <span class="at">data =</span> iris)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(iris_split) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_paper</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">0</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"800px"</span>, <span class="at">height =</span> <span class="st">"500px"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; overflow-x: scroll; width:800px; ">
<table class="lightable-paper caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; position: sticky; top: 0; background-color: #FFFFFF;">Sepal.Length</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; position: sticky; top: 0; background-color: #FFFFFF;">Sepal.Width</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; position: sticky; top: 0; background-color: #FFFFFF;">Petal.Length</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; position: sticky; top: 0; background-color: #FFFFFF;">Petal.Width</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; position: sticky; top: 0; background-color: #FFFFFF;">Species</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; position: sticky; top: 0; background-color: #FFFFFF;">my.folds</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">0.3</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">1.9</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.9</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">4.2</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.2</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.9</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.9</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">5.4</td>
<td style="text-align: right;">2.1</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.3</td>
<td style="text-align: right;">2.7</td>
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.4</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.3</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.3</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">4.7</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.4</td>
<td style="text-align: right;">2.7</td>
<td style="text-align: right;">5.3</td>
<td style="text-align: right;">1.9</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.3</td>
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.5</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">5.5</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.2</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.5</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7.9</td>
<td style="text-align: right;">3.8</td>
<td style="text-align: right;">6.4</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">7.0</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">4.7</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">3.8</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.4</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.2</td>
<td style="text-align: right;">2.7</td>
<td style="text-align: right;">3.9</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.4</td>
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">4.3</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.1</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.1</td>
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">4.7</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7.6</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">6.6</td>
<td style="text-align: right;">2.1</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.3</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">3.6</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.4</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.8</td>
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.7</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">5.8</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">7.7</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">6.7</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.9</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">2.7</td>
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.6</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.4</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.4</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.4</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">5.3</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7.2</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.4</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.4</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">1.1</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">7.3</td>
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">6.3</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.9</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">5.7</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.5</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">5.8</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.8</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.8</td>
<td style="text-align: right;">2.7</td>
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">1.9</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.4</td>
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.2</td>
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">4.3</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.5</td>
<td style="text-align: right;">4.2</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.3</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.6</td>
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">4.6</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.1</td>
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.5</td>
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">4.4</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.5</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">5.2</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.7</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">4.7</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.7</td>
<td style="text-align: right;">3.8</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">0.3</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.7</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">7.2</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">5.8</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: right;">0.4</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.3</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.9</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.3</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.8</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.5</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.8</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">5.9</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.3</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: right;">4.4</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.4</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">7.7</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">6.1</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.8</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">3.8</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.3</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">7.4</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">6.1</td>
<td style="text-align: right;">1.9</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.2</td>
<td style="text-align: right;">4.1</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.8</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">5.5</td>
<td style="text-align: right;">2.1</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.1</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">4.7</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7.1</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">5.9</td>
<td style="text-align: right;">2.1</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.7</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.5</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.2</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: right;">0.6</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">4.1</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7.7</td>
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">6.9</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.4</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.7</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">5.2</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7.2</td>
<td style="text-align: right;">3.6</td>
<td style="text-align: right;">6.1</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.2</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">3.6</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.4</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">2.1</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.8</td>
<td style="text-align: right;">2.7</td>
<td style="text-align: right;">3.9</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">3.6</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.6</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.3</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.4</td>
<td style="text-align: right;">3.9</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">0.4</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.5</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.2</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">5.4</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.1</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">4.6</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.7</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">4.2</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.3</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">1.1</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.4</td>
<td style="text-align: right;">3.9</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">0.4</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.6</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">4.4</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.5</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.7</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">0.3</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.7</td>
<td style="text-align: right;">4.4</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.4</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.8</td>
<td style="text-align: right;">2.7</td>
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">1.9</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.4</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">5.5</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.7</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.6</td>
<td style="text-align: right;">3.6</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">2.7</td>
<td style="text-align: right;">4.2</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">3.9</td>
<td style="text-align: right;">1.1</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.7</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.9</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.6</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.1</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.4</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.7</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">5.7</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">7.7</td>
<td style="text-align: right;">3.8</td>
<td style="text-align: right;">6.7</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.7</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.8</td>
<td style="text-align: right;">2.7</td>
<td style="text-align: right;">4.1</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.7</td>
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">4.2</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">3.8</td>
<td style="text-align: right;">1.9</td>
<td style="text-align: right;">0.4</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.7</td>
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.7</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">4.4</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.5</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">3.8</td>
<td style="text-align: right;">1.1</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.3</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.7</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">4.1</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.3</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.5</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">4.6</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.3</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">1.9</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.7</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">5.7</td>
<td style="text-align: right;">2.1</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
<p>The function returns the following. Essentially, all we have done is add a column with a partition number assigned. This in itself is only one stage of k-fold cross validation. The next function I will make is an arranging function. Once again it is an intermediary step in the algorithm.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>k_fold_arrange <span class="ot">&lt;-</span> <span class="cf">function</span>(k, data){</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Call previous function</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  k_data <span class="ot">=</span> <span class="fu">k_fold_split</span>(k, data)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Initialize list</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  k_list <span class="ot">=</span> <span class="fu">vector</span>(<span class="st">"list"</span>, k)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Fill the list</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    k_list[[i]] <span class="ot">=</span> k_data</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    test_indices <span class="ot">=</span> <span class="fu">which</span>(k_data<span class="sc">$</span>my.folds <span class="sc">==</span> i)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    train_indices <span class="ot">=</span> <span class="fu">which</span>(k_data<span class="sc">$</span>my.folds <span class="sc">!=</span> i)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    k_list[[i]]<span class="sc">$</span>my.folds[test_indices] <span class="ot">=</span> <span class="st">"testing"</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    k_list[[i]]<span class="sc">$</span>my.folds[train_indices] <span class="ot">=</span> <span class="st">"training"</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">next</span>(i)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(k_list)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>k_fold_arrange()</code> function calls the <code>k_fold_split()</code> function takes the partition numbers and creates <span class="math inline">\(k\)</span> data sets, with the partition column having two values. The two values will be “training” and “testing”. It stores these data sets in a list and return the list.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>iris_arrange <span class="ot">=</span> <span class="fu">k_fold_arrange</span>(<span class="at">k =</span> <span class="dv">10</span>, <span class="at">data =</span> iris)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(iris_arrange[[<span class="dv">1</span>]]) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_paper</span>() <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">0</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"800px"</span>, <span class="at">height =</span> <span class="st">"500px"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; overflow-x: scroll; width:800px; ">
<table class="lightable-paper caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; position: sticky; top: 0; background-color: #FFFFFF;">Sepal.Length</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; position: sticky; top: 0; background-color: #FFFFFF;">Sepal.Width</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; position: sticky; top: 0; background-color: #FFFFFF;">Petal.Length</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; position: sticky; top: 0; background-color: #FFFFFF;">Petal.Width</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; position: sticky; top: 0; background-color: #FFFFFF;">Species</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; position: sticky; top: 0; background-color: #FFFFFF;">my.folds</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">6.5</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">5.8</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.4</td>
<td style="text-align: right;">3.9</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">0.4</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.6</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.2</td>
<td style="text-align: right;">4.1</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.3</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.1</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.7</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7.7</td>
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">6.9</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">3.8</td>
<td style="text-align: right;">1.9</td>
<td style="text-align: right;">0.4</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.3</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.9</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.1</td>
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">4.7</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.2</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">7.6</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">6.6</td>
<td style="text-align: right;">2.1</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.7</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.8</td>
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.4</td>
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.7</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">5.2</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.4</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">5.3</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.6</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.3</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">testing</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.6</td>
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">4.6</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7.1</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">5.9</td>
<td style="text-align: right;">2.1</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.3</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.7</td>
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">4.2</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: right;">0.4</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7.9</td>
<td style="text-align: right;">3.8</td>
<td style="text-align: right;">6.4</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">3.9</td>
<td style="text-align: right;">1.1</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">testing</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.4</td>
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">4.3</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">testing</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: right;">0.6</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.7</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">5.7</td>
<td style="text-align: right;">2.1</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">7.2</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">3.8</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.3</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.1</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.7</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">5.7</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.4</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.6</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">4.4</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">0.3</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.8</td>
<td style="text-align: right;">2.7</td>
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">1.9</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.7</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.3</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: right;">4.4</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.4</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.4</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">testing</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.8</td>
<td style="text-align: right;">2.7</td>
<td style="text-align: right;">3.9</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.7</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.5</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.3</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.2</td>
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">4.3</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">testing</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.4</td>
<td style="text-align: right;">2.7</td>
<td style="text-align: right;">5.3</td>
<td style="text-align: right;">1.9</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.5</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.8</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.8</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.5</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">5.5</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.1</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">4.6</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.4</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">testing</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.9</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">2.7</td>
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.3</td>
<td style="text-align: right;">2.7</td>
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.5</td>
<td style="text-align: right;">4.2</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.5</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">3.8</td>
<td style="text-align: right;">1.1</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.9</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.3</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">testing</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.1</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">4.7</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.5</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.3</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">1.9</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">7.3</td>
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">6.3</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.9</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">4.2</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.5</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">4.6</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.7</td>
<td style="text-align: right;">4.4</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.4</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.2</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">5.4</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">testing</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.7</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">4.4</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">3.6</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.4</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.7</td>
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">testing</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.8</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.5</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.9</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">5.4</td>
<td style="text-align: right;">2.1</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">7.7</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">6.1</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.3</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.7</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.5</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">5.2</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">testing</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7.7</td>
<td style="text-align: right;">3.8</td>
<td style="text-align: right;">6.7</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">testing</td>
</tr>
<tr class="even">
<td style="text-align: right;">7.2</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">5.8</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.6</td>
<td style="text-align: right;">3.6</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">0.3</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.2</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.9</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.4</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">2.1</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.4</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.4</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.4</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">3.6</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.4</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.9</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">5.7</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.7</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">5.8</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.4</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">5.5</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">1.1</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.8</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">5.9</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.7</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">4.7</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">3.8</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.6</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.7</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.8</td>
<td style="text-align: right;">2.7</td>
<td style="text-align: right;">4.1</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.1</td>
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">7.0</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">4.7</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">testing</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.2</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.8</td>
<td style="text-align: right;">2.7</td>
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">1.9</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7.7</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">6.7</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.7</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">4.1</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">4.1</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7.2</td>
<td style="text-align: right;">3.6</td>
<td style="text-align: right;">6.1</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.2</td>
<td style="text-align: right;">2.7</td>
<td style="text-align: right;">3.9</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">testing</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.7</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">4.2</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">1.9</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">testing</td>
</tr>
<tr class="even">
<td style="text-align: right;">7.4</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">6.1</td>
<td style="text-align: right;">1.9</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.3</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">1.1</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.3</td>
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.5</td>
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">4.4</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.7</td>
<td style="text-align: right;">3.8</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">0.3</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.8</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">5.5</td>
<td style="text-align: right;">2.1</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.3</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">4.7</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">2.7</td>
<td style="text-align: right;">4.2</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">3.6</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.4</td>
<td style="text-align: right;">3.9</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">0.4</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.5</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
<td style="text-align: left;">testing</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.3</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.2</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: left;">virginica</td>
<td style="text-align: left;">training</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.4</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
<td style="text-align: left;">training</td>
</tr>
</tbody>
</table>
</div>

</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Test whether each data set has equal samples for testing and training</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>equal_test <span class="ot">=</span> <span class="cn">TRUE</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">all</span>(<span class="fu">table</span>(iris_arrange[[j]]<span class="sc">$</span>my.folds)[[<span class="dv">1</span>]] <span class="sc">==</span> <span class="dv">15</span>, </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">table</span>(iris_arrange[[j]]<span class="sc">$</span>my.folds)[[<span class="dv">2</span>]] <span class="sc">==</span> <span class="dv">135</span>)){</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">next</span>(i)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    equal_test <span class="ot">=</span> <span class="cn">FALSE</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(equal_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>As expected each of the 10 data sets has 15 observations for testing and and 135 for training. Finally, we implement the cross validation function. In-built libraries in R typically have the <span class="math inline">\(k\)</span> fold splitting step of the data, the model and the average metric calculating heavily integrated together. Since this is a from scratch implementation, I will not be able to have the same level of integration. As such my cross validation function will not be end to end. It will not be able to provide the final accuracy of a model. If you would like to see an end to end implementation see the <code>caret</code> package; the caret package builds a k-fold control, which can then be piped directly into other models in R. Rather my function will just provide the <span class="math inline">\(k\)</span> data sets, in a way that makes it easy to iterate through them and calculate a performance metric for them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>k_fold_cv <span class="ot">&lt;-</span> <span class="cf">function</span>(k, data){</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Call previous function</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  k_data <span class="ot">=</span> <span class="fu">k_fold_arrange</span>(k, data)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Initialize new list</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  k_list <span class="ot">=</span> <span class="fu">vector</span>(<span class="st">"list"</span>, k)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    dat <span class="ot">=</span> k_data[[i]]</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    k_train <span class="ot">=</span> <span class="fu">subset</span>(dat, dat<span class="sc">$</span>my.folds <span class="sc">==</span> <span class="st">"training"</span>)[, <span class="sc">-</span><span class="fu">ncol</span>(dat)]</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    k_test <span class="ot">=</span> <span class="fu">subset</span>(dat, dat<span class="sc">$</span>my.folds <span class="sc">==</span> <span class="st">"testing"</span>)[, <span class="sc">-</span><span class="fu">ncol</span>(dat)]</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    total_list <span class="ot">=</span> <span class="fu">list</span>(k_train, k_test)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    k_list[[i]] <span class="ot">=</span> total_list</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">next</span>(i)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(k_list)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The above function simply calls the arrange function, and creates a list of <span class="math inline">\(k\)</span> elements. The first element is the instance where the first fold will be used to train. So in the first element of the list, there is another list of two elements. The first element of this list are the training samples and the second are the testing samples. This pattern goes on for all <span class="math inline">\(k\)</span> elements of the list. Look at the below output, which is three folds on iris to get a better idea.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(<span class="fu">k_fold_cv</span>(<span class="at">k =</span> <span class="dv">3</span>, <span class="at">data =</span> iris))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre style="max-height: 250px;"><code>List of 3
 $ :List of 2
  ..$ :'data.frame':    100 obs. of  5 variables:
  .. ..$ Sepal.Length: num [1:100] 6.1 5.6 6.5 5.5 5.9 4.9 5.7 5.2 6.3 7.7 ...
  .. ..$ Sepal.Width : num [1:100] 3 2.9 2.8 2.6 3 3.6 3.8 3.4 2.9 3.8 ...
  .. ..$ Petal.Length: num [1:100] 4.6 3.6 4.6 4.4 4.2 1.4 1.7 1.4 5.6 6.7 ...
  .. ..$ Petal.Width : num [1:100] 1.4 1.3 1.5 1.2 1.5 0.1 0.3 0.2 1.8 2.2 ...
  .. ..$ Species     : Factor w/ 3 levels "setosa","versicolor",..: 2 2 2 2 2 1 1 1 3 3 ...
  ..$ :'data.frame':    50 obs. of  5 variables:
  .. ..$ Sepal.Length: num [1:50] 6.7 5.1 6.3 7 6.9 6.4 5.4 5.1 6.8 4.9 ...
  .. ..$ Sepal.Width : num [1:50] 2.5 3.8 2.7 3.2 3.2 2.9 3 3.7 2.8 2.5 ...
  .. ..$ Petal.Length: num [1:50] 5.8 1.5 4.9 4.7 5.7 4.3 4.5 1.5 4.8 4.5 ...
  .. ..$ Petal.Width : num [1:50] 1.8 0.3 1.8 1.4 2.3 1.3 1.5 0.4 1.4 1.7 ...
  .. ..$ Species     : Factor w/ 3 levels "setosa","versicolor",..: 3 1 3 2 3 2 2 1 2 3 ...
 $ :List of 2
  ..$ :'data.frame':    100 obs. of  5 variables:
  .. ..$ Sepal.Length: num [1:100] 6.7 5.1 6.3 5.5 5.9 4.9 5.7 5.2 6.3 6 ...
  .. ..$ Sepal.Width : num [1:100] 2.5 3.8 2.7 2.6 3 3.6 3.8 3.4 2.9 3.4 ...
  .. ..$ Petal.Length: num [1:100] 5.8 1.5 4.9 4.4 4.2 1.4 1.7 1.4 5.6 4.5 ...
  .. ..$ Petal.Width : num [1:100] 1.8 0.3 1.8 1.2 1.5 0.1 0.3 0.2 1.8 1.6 ...
  .. ..$ Species     : Factor w/ 3 levels "setosa","versicolor",..: 3 1 3 2 2 1 1 1 3 2 ...
  ..$ :'data.frame':    50 obs. of  5 variables:
  .. ..$ Sepal.Length: num [1:50] 6.1 5.6 6.5 7.7 6.1 5.7 6.4 4.8 5.8 4.4 ...
  .. ..$ Sepal.Width : num [1:50] 3 2.9 2.8 3.8 2.8 2.6 2.8 3 2.7 2.9 ...
  .. ..$ Petal.Length: num [1:50] 4.6 3.6 4.6 6.7 4 3.5 5.6 1.4 3.9 1.4 ...
  .. ..$ Petal.Width : num [1:50] 1.4 1.3 1.5 2.2 1.3 1 2.1 0.3 1.2 0.2 ...
  .. ..$ Species     : Factor w/ 3 levels "setosa","versicolor",..: 2 2 2 3 2 2 3 1 2 1 ...
 $ :List of 2
  ..$ :'data.frame':    100 obs. of  5 variables:
  .. ..$ Sepal.Length: num [1:100] 6.7 6.1 5.1 5.6 6.3 6.5 7.7 6.1 7 5.7 ...
  .. ..$ Sepal.Width : num [1:100] 2.5 3 3.8 2.9 2.7 2.8 3.8 2.8 3.2 2.6 ...
  .. ..$ Petal.Length: num [1:100] 5.8 4.6 1.5 3.6 4.9 4.6 6.7 4 4.7 3.5 ...
  .. ..$ Petal.Width : num [1:100] 1.8 1.4 0.3 1.3 1.8 1.5 2.2 1.3 1.4 1 ...
  .. ..$ Species     : Factor w/ 3 levels "setosa","versicolor",..: 3 2 1 2 3 2 3 2 2 2 ...
  ..$ :'data.frame':    50 obs. of  5 variables:
  .. ..$ Sepal.Length: num [1:50] 5.5 5.9 4.9 5.7 5.2 6.3 6 4.8 5.2 5.1 ...
  .. ..$ Sepal.Width : num [1:50] 2.6 3 3.6 3.8 3.4 2.9 3.4 3 2.7 3.8 ...
  .. ..$ Petal.Length: num [1:50] 4.4 4.2 1.4 1.7 1.4 5.6 4.5 1.4 3.9 1.9 ...
  .. ..$ Petal.Width : num [1:50] 1.2 1.5 0.1 0.3 0.2 1.8 1.6 0.1 1.4 0.4 ...
  .. ..$ Species     : Factor w/ 3 levels "setosa","versicolor",..: 2 2 1 1 1 3 2 1 2 1 ...</code></pre>
</div>
</div>
<p>For most users the <code>k_fold_cv()</code> this function will be good enough (assuming that anyone will ever use), as once they have the data sets, it is just a matter of training it on each of the <span class="math inline">\(k\)</span> training sets, testing on the corresponding <span class="math inline">\(k\)</span> testings sets, calculating the performance metric, and then averaging it across. Any of the above functions will likely be good enough for an user to carry out cross validation.</p>
<p>Once again, I have shown below how you can use the above function to find the k-fold cross validated accuracy for a naive bayes classifier.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">23813</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>ksplit <span class="ot">=</span> <span class="fu">k_fold_split</span>(<span class="at">k =</span> <span class="dv">10</span>, <span class="at">data =</span> iris)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>klist <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  traink <span class="ot">=</span> <span class="fu">subset</span>(ksplit, ksplit<span class="sc">$</span>my.folds <span class="sc">!=</span> k)[, <span class="sc">-</span><span class="dv">6</span>]</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  testk <span class="ot">=</span> <span class="fu">subset</span>(ksplit, ksplit<span class="sc">$</span>my.folds <span class="sc">==</span> k)[, <span class="sc">-</span><span class="dv">6</span>]</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  NBclassifier <span class="ot">=</span> <span class="fu">naiveBayes</span>(Species <span class="sc">~</span> Sepal.Length <span class="sc">+</span> Sepal.Width <span class="sc">+</span> </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>                              Petal.Length <span class="sc">+</span> Petal.Width, </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>                            <span class="at">data =</span> ksplit)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  NBpredict <span class="ot">=</span> <span class="fu">predict</span>(NBclassifier, <span class="at">newdata =</span> testk, <span class="at">type =</span> <span class="st">"class"</span>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  NBequals <span class="ot">=</span> (testk<span class="sc">$</span>Species <span class="sc">==</span> NBpredict)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  NBaccuracy <span class="ot">=</span> <span class="fu">length</span>(<span class="fu">which</span>(NBequals <span class="sc">==</span> <span class="cn">TRUE</span>))<span class="sc">/</span><span class="fu">length</span>(NBequals)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  NBweighted <span class="ot">=</span> NBaccuracy<span class="sc">*</span>(<span class="fu">nrow</span>(testk)<span class="sc">/</span><span class="fu">nrow</span>(ksplit))</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  klist[k] <span class="ot">=</span> NBweighted</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(klist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.96</code></pre>
</div>
</div>
<p>The average accuracy of the model is 96%.</p>
</section>
<section id="choice-of-k-repeated-cv-and-loocv" class="level1">
<h1>Choice of <span class="math inline">\(k\)</span>, repeated CV and LOOCV</h1>
<p>Users of k-fold cross validation typically default to using <span class="math inline">\(k=5\)</span> or <span class="math inline">\(k=10\)</span>, but why? First of all it is important to note that the <span class="math inline">\(k\)</span> chosen should be dependent on the size of the data you are using. A smaller <span class="math inline">\(k\)</span> should be used if you have less samples, and a higher <span class="math inline">\(k\)</span> may be used if you have more. The logic behind this is simple. Recall that the more you increase <span class="math inline">\(k\)</span>, the larger the training set gets, and the smaller the testing set gets. So a larger <span class="math inline">\(k\)</span> relative to a small data set would mean that there would not be many testing samples. This would not produce a robust estimate if run. When the size of the data set increases, we can afford a higher <span class="math inline">\(k\)</span> for the same reason as above. All in all, the choice of <span class="math inline">\(k\)</span> should “balance the trade off between having enough folds to get a good estimate, while not have so less folds that model training becomes too computationally expensive”. So the answer to why values of 5 and 10 is not a straightforward one. These values have some empirical backing behind them, but I would say that they are just guides or a safe bet you can use if unsure.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/bvterrormet.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
<p>Remember that the purpose of the k-fold CV is to produce an estimate of how well the model performs, and generalizes to unseen cases. So another option in addition to this would be to run repeated k-fold CV. What this means is you run the algorithm once, then shuffle the data again, and run the algorithm again. This should produce a completely new split of data among the folds. This process can be repeated to any amount of times. The idea behind repeated k-fold CV is that you iterate through as many feasible model/test sample combination from the test data as possible. One thing to note with this approach is that a large <span class="math inline">\(k\)</span> has a limited amount of possible iterations, so it does not make sense to use repeated k-fold CV. For example in “leave one out cross validation” (LOOCV), there are <span class="math inline">\({n \choose 1} = n= k\)</span> different model/test sample splits, so it does not make sense to to try run repeated LOOCV, as the LOOCV by itself captures all the different iterations of the data set. By comparison if <span class="math inline">\(n = 20\)</span> and <span class="math inline">\(k = 10\)</span> there would be <span class="math inline">\({20 \choose 10} = 190 = 19k\)</span> different iterations (possible splits). These iterations would not be captured in a single run of k-fold, so it may make sense to try go through all of them via repeated k-fold CV. All of this is of course under the assumption that computational complexity is irrelevant.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/irr_error.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:40.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/bvt.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
<p>There is one last thing to note here. Repeated k-fold CV is geared to when we are working with a data set with a small amount of samples; we are trying to average the model performance across as many random instances of our available data as computationally possible. When you have a large data set with many samples the difference between the “trained model” and the “globally best model” becomes negligible. This is where one lands upon a flatter part of the learning curve. Again, such only occurs when you have carefully chose your model; it does not overfit or underfit.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p><i class="fa-regular fa-copyright" aria-label="copyright"></i> Rashmin Chitale, 2024<br> All content licensed under <i class="fa-brands fa-creative-commons" aria-label="creative-commons"></i> <i class="fa-brands fa-creative-commons-by" aria-label="creative-commons-by"></i> <i class="fa-brands fa-creative-commons-sa" aria-label="creative-commons-sa"></i> <i class="fa-brands fa-creative-commons-nc" aria-label="creative-commons-nc"></i> <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">(CC BY-NC-SA 4.0)</a><br></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Made with <i class="fa-brands fa-r-project" aria-label="r-project"></i>, <a href="https://quarto.org/">Quarto</a> and code snippets from <a href="../..\posts/quarto-website-migration.html">these folks</a> <i class="fa-solid fa-users" aria-label="users"></i> <br> <a href="https://github.com/Rcshmin/rcpersonalweb">Source code at GitHub</a> <i class="fa-brands fa-github" aria-label="github"></i></p>
</div>
  </div>
</footer>




</body></html>